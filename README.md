# illumio-assessment-aniket
The repository contains the code which reads and processes flow log data, mapping each row to a tag based on a lookup table. The program generates counts of matches for each tag and port/protocol combination, which can be useful for analyzing network traffic.

# Flow Log Tagging Program

## Introduction
This program reads a flow log file and maps each row to a tag based on a lookup table. It processes the flow log data to generate counts of matches for each tag and for each port/protocol combination.

## Assumptions Made
- The program only supports the default flow log format, not custom formats.
- It only supports flow log version 2.
- The input flow log file and the lookup table file are plain text (ASCII) files.
- The program assumes that the flow log file is well-formed and has the expected number of fields.
- Protocol numbers are mapped to protocol names using the standard IANA protocol numbers list.
- The matches between flow logs and the lookup table are case-insensitive.

## Instructions to Run the Program

### Prerequisites:
- Make sure you have Python 3 installed on your computer.

### Files Needed:
- `main.py`: The main script to run the program.
- `generate_flow_logs.py`: Script to generate the flow log file (`flow_logs.txt`).
- `generate_lookup_table.py`: Script to generate the lookup table file (`lookup_table.csv`).
- `lookup_table.py`: Contains the function to load the lookup table.
- `map_protocol.py`: Contains the function to map protocol numbers to protocol names.
- `process_flow_logs.py`: Contains the function to process the flow logs.
- `generate_outputs.py`: Contains the function to generate the output file.
- `flow_logs.txt`: The flow log file generated by `generate_flow_logs.py`.
- `lookup_table.csv`: The lookup table file generated by `generate_lookup_table.py`.
- `output.txt`: The output file that will be generated.

### Generating the Data Files:

1. Run the `generate_flow_logs.py` script to create a sample flow log file with around 10 MB of data:
     ```bash
   python3 generate_flow_logs.py

2. Run the `generate_lookup_table.py` script to create a lookup table with 10,000 mappings:

    ```bash
    python3 generate_lookup_table.py

### Running the Program:

Run the `main.py` script to process the flow logs and generate the output:

    python3 main.py

### Viewing the Results:

Open the `output.txt` file to see the counts of matches for each tag and each port/protocol combination.

## Tests Performed

### Functionality Test:
- Generated sample flow logs and lookup table using the provided scripts.
- Ran the main program to ensure it processes the data without errors and produces the expected output.

### Edge Case Testing:
- Tested with flow logs containing unknown protocol numbers to check if the program handles them gracefully.
- Verified that the program correctly matches entries regardless of the case (upper or lower) of the protocol names.

### Performance Test:
- Processed a flow log file of approximately 10 MB to ensure the program performs efficiently and completes in a reasonable time.

## Analysis of the Code

### Assumptions Clarification:
- The program assumes that all flow log entries are in the default format and version 2.
- It does not support custom flow log formats or other versions.

### Code Structure:
- The code is organized into separate modules for better readability and maintainability.
- Functions are modular, making it easier to update or modify specific parts of the program.

### Efficiency:
- Used dictionaries for quick lookup operations, which improves performance, especially with large datasets.

### Error Handling:
- The program skips empty lines and malformed entries to prevent crashes.
- Entries that do not match any tag in the lookup table are counted as 'Untagged'.

### Extensibility:
- The protocol mapping can be updated to include more protocols if needed.
- The program can be modified to support other flow log formats with additional coding.


